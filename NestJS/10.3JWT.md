# JWT (JSON Web Token)

JWT1λ” [RFC 7519](https://datatracker.ietf.org/doc/html/rfc7519)μ— μ†κ°λ κ²ƒμΌλ΅μ¨ λ¬Έμ„μ μ΄λ΅μ— λ”°λ¥΄λ©΄ λ‹¤μκ³Ό κ°™λ‹¤.

> JWTλ” λ‘ λ‹Ήμ‚¬μ μ‚¬μ΄μ— μ΄μ „λ  μ μλ” ν΄λ μ„μ„ λ‚νƒ€λ‚΄λ” κ°„κ²°ν•κ³  URLμ— μ•μ „ν• λ°©λ²•μ…λ‹λ‹¤. JWTμ— ν¬ν•¨λ ν΄λ μ„μ€ JSON κ°μ²΄λ΅ μΈμ½”λ”©λμ–΄ JSON μ›Ή μ„λ…(JWS, JSON Web Signature)μ νμ΄λ΅λ“ λλ” JSON μ›Ή μ•”νΈν™”(JWE, JSON Web Encryption)μ μΌλ° ν…μ¤νΈλ΅ μ‚¬μ©λ©λ‹λ‹¤. ν΄λ μ„μ„ λ””μ§€ν„Έ λ°©μ‹μΌλ΅ μ„λ…ν•κ±°λ‚ λ©”μ‹μ§€ μΈμ¦ μ½”λ“(MAC, Message Authentication Code)λ΅ μ•”νΈν™” λμ–΄ λ¬΄κ²°μ„±μ„ λ³΄νΈν•©λ‹λ‹¤.

[jwt.io](https://jwt.io/) μ—μ„ JSON κ°μ²΄λ΅ JWTλ¥Ό μΈμ½”λ”©ν•΄ λ³΄κ±°λ‚ μΈμ½”λ”©λμ–΄ μλ” JWTλ¥Ό μ…λ ¥ν•μ—¬ JSON κ°μ²΄λ΅ λ””μ½”λ”© ν•΄ λ³Ό μ μλ‹¤.

## JWT κµ¬μ„±μ”μ†

JWTλ” ν—¤λ”, νμ΄λ΅λ“, μ‹κ·Έλ„μ² 3κ°€μ§€ μ”μ†λ¥Ό κ°€μ§€λ©° μ (.)μΌλ΅ κµ¬λ¶„λλ‹¤. ν—¤λ”μ™€ νμ΄λ΅λ“λ” κ°κ° base64λ΅ μΈμ½”λ”©λμ–΄ μλ‹¤. base64λ΅ μΈμ½”λ”©μ„ ν•λ©΄ μ‚¬λμ΄ μ½μ„ μ μ—†κ³  λ””μ½”λ”©μ΄ ν•„μ”ν•μ§€λ§ JWTλ¥Ό HTTP ν—¤λ”λ‚ μ”μ²­ νλΌλ―Έν„° λλ” νΌ νλΌλ―Έν„°λ΅ μ‚¬μ©ν•  μ μκ² λλ‹¤. λ JSON λ¬Έμμ—΄μ΄ λ°μ΄ν„°λ² μ΄μ¤λ‚ ν”„λ΅κ·Έλλ° μ–Έμ–΄μ—μ„ μ§€μ›ν•μ§€ μ•λ” λ¬Έμμ—΄μ„ μ‚¬μ©ν•  κ²½μ°λ” μ‚¬μ©μ΄ λ¶κ°€λ¥ ν•κΈ° λ•λ¬Έμ— μ΄ κ²½μ°λ¥Ό μ„ν•΄ base64 μΈμ½”λ”©μ΄ ν•„μ”ν•λ‹¤.

## 1. ν—¤λ”

λ¨Όμ € μ (.)μΌλ΅ κµ¬λ¶„λ κ°€μ¥ μ²«λ²μ§Έ λ¬Έμμ—΄μ€ ν—¤λ”, ν—¤λ”λ” μΌλ°μ μΌλ΅ JWTμ μ ν•("typ")κ³Ό μ–΄λ–¤ μ•κ³ λ¦¬μ¦("alg")μ— μν•΄ μΈμ½”λ”©λμ—λ” μ§€λ¥Ό ν¬ν•¨ν•λ‹¤.

```json
{
    "typ":"JWT",
    "alg":"HS256"
}
```

- `"typ"` νλΌλ―Έν„°λ” [JWS](https://datatracker.ietf.org/doc/html/rfc7515)μ™€ [JWE](https://datatracker.ietf.org/doc/html/rfc7516)μ— μ •μλ λ―Έλ””μ–΄ νƒ€μ…μ΄λ‹¤. μ΄λ” JWTλ¥Ό μ²λ¦¬ν•λ” μ• ν”λ¦¬μΌ€μ΄μ…μ—κ² νμ΄λ΅λ“κ°€ λ¬΄μ—‡μΈμ§€λ¥Ό μ•λ ¤μ£Όλ” μ—­ν• μ„ ν•λ‹¤. μ¦‰, μ΄ ν† ν°μ€ JWTλΌλ” κ²ƒμ„ λ»ν•λ―€λ΅ `"JWT"`λΌλ” κ°’μΌλ΅ μ •μν•λΌκ³  κ¶κ³ ν•κ³  μλ” κ²ƒμ΄λ‹¤.

- `"alg"` νλΌλ―Έν„°λ” ν† ν°μ„ μ•”νΈν™” ν•λ” μ•κ³ λ¦¬μ¦μ΄λ‹¤. μ•”νΈν™”ν•μ§€ μ•μ„ κ²½μ°λ” `"none"`μΌλ΅ μ •μν•κ³ , μ•”νΈν™”λ¥Ό ν•  κ²½μ° ν•΄λ‹Ή μ•κ³ λ¦¬μ¦μ„ κΈ°μ ν•λ‹¤. μ„μ μμ—μ„λ” HS256μΌλ΅ ν† ν°μ„ μ•”νΈν™”ν–λ‹¤λ” λ»μ΄λ‹¤.

## 2. νμ΄λ΅λ“

νμ΄λ΅λ“μ—λ” ν΄λ μ„(claim)μ΄λΌ λ¶€λ¥΄λ” μ •λ³΄λ¥Ό ν¬ν•¨ν•λ‹¤.

### λ“±λ΅λ(Registered) ν΄λ μ„

IANA JWT ν΄λ μ„ λ μ§€μ¤νΈλ¦¬μ— λ“±λ΅λ ν΄λ μ„μ΄λ‹¤. ν•„μλ” μ•„λ‹μ§€λ§ JWTλ¥Ό μƒνΈ νΈν™μ„±μ„ κ°€μ§€λ ¤λ©΄ μ‘μ„±ν•΄μ•Ό ν•λ‹¤.

- `"iss"`(Issuer, λ°κΈ‰μ): λ„κ°€ ν† ν°μ„ λ°κΈ‰(μƒμ„±)ν–λ”μ§€λ¥Ό λ‚νƒ€λ‚Έλ‹¤. μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ μ„μλ΅ μ •μν• λ¬Έμμ—΄ λλ” URI ν•μ‹μ„ κ°€μ§„λ‹¤.
- `"sub"` (Subject, μ£Όμ ): μΌλ°μ μΌλ΅ μ£Όμ μ— λ€ν• μ„¤λ…μ„ λ‚νƒ€λ‚Έλ‹¤. ν† ν° μ£Όμ λ” λ°κΈ‰μκ°€ μ •μν•λ” λ¬Έλ§¥μƒ λλ” μ „μ—­μΌλ΅ μ μΌν• κ°’μ„ κ°€μ Έμ•Ό ν•λ‹¤. λ¬Έμμ—΄ λλ” URI ν•μ‹μ„ κ°€μ§„λ‹¤.
- `"aud"` (Audience, μμ‹ μ): λ„κµ¬μ—κ² ν† ν°μ΄ μ „λ‹¬λλ” κ°€λ¥Ό λ‚νƒ€λ‚Έλ‹¤. μ£Όλ΅ λ³΄νΈλ λ¦¬μ†μ¤μ URLμ„ κ°’μΌλ΅ μ„¤μ •ν•λ‹¤.
- `"exp"` (Expiration, λ§λ£ μ‹κ°„): μ–Έμ  ν† ν°μ΄ λ§λ£λλ”μ§€λ¥Ό λ‚νƒ€λ‚Έλ‹¤. λ§λ£ μ‹κ°„μ΄ μ§€λ‚ ν† ν°μ€ μλ½λμ–΄μ„λ” μ•λλ‹¤. μΌλ°μ μΌλ΅ UNIX Epoch μ‹κ°„μ„ μ‚¬μ©ν•λ‹¤.
- `"nbf"` (Not Before): μ •μλ μ‹κ°„ μ΄ν›„μ— ν† ν°μ΄ ν™μ„±ν™”λλ‹¤. ν† ν°μ΄ μ ν¨ν•΄ μ§€λ” μ‹κ°„ μ΄μ „μ— λ―Έλ¦¬ λ°κΈ‰λλ” κ²½μ° μ‚¬μ©ν•λ‹¤. μΌλ°μ μΌλ΅ UNIX Epoch μ‹κ°„μ„ μ‚¬μ©ν•λ‹¤.
- `"iat"` (Issued At, ν† ν° λ°κΈ‰ μ‹κ°„): μ–Έμ  ν† ν°μ΄ λ°κΈ‰λμ—λ”μ§€λ¥Ό λ‚νƒ€λ‚Έλ‹¤. μΌλ°μ μΌλ΅ UNIX Epoch μ‹κ°„μ„ μ‚¬μ©ν•λ‹¤.
- `"jti"` (JWT ID, ν† ν° μ‹λ³„μ): ν† ν°μ κ³ μ  μ‹λ³„μλ΅μ¨ κ°™μ€ κ°’μ„ κ°€μ§ ν™•λ¥ μ΄ μ—†λ” μ•”νΈν•™μ  λ°©λ²•μΌλ΅ μƒμ„±λμ–΄μ•Ό ν•λ‹¤. κ³µκ²©μκ°€ JWTλ¥Ό μ¬μ‚¬μ©ν•λ” κ²ƒμ„ λ°©μ§€ν•κΈ° μ„ν•΄ μ‚¬μ©ν•λ‹¤.

## κ³µκ°(public) ν΄λ μ„

JWT λ°κΈ‰μμ™€ μ‚¬μ©μκ°„μ— μ‚¬μ©ν•κΈ°λ΅ μ•½μ†ν• ν΄λ μ„μ΄λ‹¤. μ΄λ¦„ μ¶©λμ΄ λ°μƒν•μ§€ μ•λ„λ΅ μ£Όμν•΄μ•„ ν•λ‹¤.

## 3. μ‹κ·Έλ‹μ²

ν—¤λ”μ™€ νμ΄λ΅λ“λ” λ‹¨μν base64λ΅ μΈμ½”λ”©ν•κΈ° λ•λ¬Έμ— κ³µκ²©μλ” ν† ν°μ„ μ›ν•λ” κ°’μ„ λ„£κ³  μƒμ„±ν•  μ μλ‹¤. λ”°λΌμ„ μƒμ„±λ ν† ν°μ΄ μ ν¨ν• μ§€ κ²€μ¦ν•λ” μ¥μΉκ°€ ν•„μ”ν•λ‹¤. ν—¤λ”μ—μ„ `"alg":"HS256"` μ΄λΌκ³  μ„ μ–Έν•λ‹¤λ©΄ μ΄ ν† ν°μ€ HMACSHA256 μ•κ³ λ¦¬μ¦μΌλ΅ μ•”νΈν™”ν•΄μ•Ό ν•λ‹¤. λ‹Ήμ—°ν μ•”νΈν™” ν•  λ• μ‚¬μ©ν•λ” secretμ€ ν† ν°μ„ μƒμ„±ν•κ³  κ²€μ¦ν•λ” μ„λ²„μ—μ„λ§ μ–Έμ „ν• λ°©λ²•μΌλ΅ μ €μ¥ν•΄μ•Ό ν•λ‹¤.

HS256 λ°©μ‹μ μ•”νΈν™”λ” ν—¤λ”μ™€ νμ΄λ΅λ“λ¥Ό base64λ΅ μΈμ½”λ”©ν• λ¬Έμμ—΄κ³Ό secret(λ‹¤μ μμ—μ„λ” `'secret'`μ΄λΌλ” λ¬Έμμ—΄μ„ μ‚¬μ©)μ„ μ΄μ©ν•μ—¬ HMACSHA256 μ•κ³ λ¦¬μ¦μ— λ„£μ–΄μ£Όλ©΄ λλ‹¤.

```ts
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  'secret'
)
```

> π’΅ JWT ν† ν°μ„ μƒμ„±ν•  λ•λ” μ§μ ‘ base64 μΈμ½”λ”©κ³Ό μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•μ§€ μ•κ³  JWT μƒμ„± λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.
μ΄ν›„ μμ‹μ—μ„ μ‚¬μ©ν•΄ λ³΄κ² μµλ‹λ‹¤.

μ•μ JWTλ¥Ό κ³µκ²©μκ°€ λ‹¤μ‹ κµ¬μ„±ν•μ—¬ νμ΄λ΅λ“λ¥Ό μμ •ν• ν›„ secretμ„ `WRONG_SECRET`μΌλ΅ μλ» μ‚¬μ©ν• JWTλ¥Ό μƒμ„±ν–λ‹¤κ³  ν•΄λ³΄μ.

```
"http://example.com/is_root": false
```

μ΄λ ‡κ² μƒμ„±λ ν† ν°μ κ°’μ€ `eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJqb2UiLCJleHAiOjEzMDA4MTkzODAsImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290IjpmYWxzZX0.Odfx2MvLVLzXYBaV8l1tlTY5Xifa46F8emgZudbhT04`μ΄λ‹¤. jwt.io μ—μ„ μ°μΈ΅ Decodedμ— μ •μƒμ μΈ μ•”νΈ(secret)λ¥Ό λ¨Όμ € μ λ€λ΅ μ…λ ¥ν•κ³ , μΆμΈ΅ Encoded μμ—­μ— μλ»λ ν† ν°μ„ λ¶™μ—¬ λ„£μΌλ©΄ Invalid SignatureλΌκ³  ν‘μ‹λλ‹¤. μλ»λ secretμΌλ΅ μΈμ½”λ”©ν–κΈ° λ•λ¬Έμ΄λ‹¤.

![μλ»λμ‹ν¬λ¦Ώ](https://wikidocs.net/images/page/158629/5.png)

> π”¥ νμ΄λ΅λ“μ— λ“¤μ–΄κ° λΉ„κ³µκ° ν΄λ μ„μ€ λΉ„λ°€λ²νΈμ™€ κ°™μ€ μ¤‘μ” μ •λ³΄λ¥Ό ν¬ν•¨ν•λ©΄ μ•λ©λ‹λ‹¤.  
Signatureλ” μ΄ ν† ν°μ΄ μ ν¨ν• ν† ν°μΈμ§€ κ²€μ‚¬ν•  λΏμ΄μ§€ νμ΄λ΅λ“λ¥Ό μ•”νΈν™”ν•λ”κ² μ•„λ‹κΈ° λ•λ¬Έμ…λ‹λ‹¤.